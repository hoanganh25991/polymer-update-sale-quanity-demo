<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/paper-behaviors/paper-button-behavior.html">

<dom-module id="my-firebase-list">
    <template>
        <style is="custom-style">
            :host {
                display: block;
                position: relative;
                border-radius: 3px;
                background-color: #fff;
            }
        </style>

        <content></content>
        <template is="dom-repeat" id="repeater" items="[[items]]"></template>
    </template>
    <script>
        Polymer({
            is: 'my-firebase-list',
            behaviors: [
                Polymer.Templatizer
            ],
            properties: {
                firebaseObj: {
                    type: Object,
                    reflectToAttribute: true
                },
                items: {
                    type: Array,
                    computed: '_computeItems(firebaseObj)'
                },
                searchTerm: {
                    type: String,
                    value: '',
                    reflectToAttribute: true
                },
                by: {
                    type: String,
                    value: 'name',
                    reflectToAttribute: true
                }
            },
            _computeItems: function(firebaseObj){
                return Object.keys(firebaseObj);
            },
            ready: function() {
                this.$.repeater.templatize(this.querySelector('#templ'));
                Polymer.Bind.prepareModel(this.$.repeater);
                Polymer.Base.prepareModelNotifyPath(this.$.repeater);
            },
            _computeVal: function(uuid, path){
                return this.firebaseObj[uuid][path];
            },
            _computeItemHiddenAttr: function(uuid){
                return this.firebaseObj[uuid][this.by].match(new RegExp(this.searchTerm)) ? false: true;
            }
        });
    </script>
</dom-module>